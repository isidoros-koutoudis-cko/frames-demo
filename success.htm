<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <title>Success</title>
    <style>
        body {
            font-size: 1rem;
            margin: 0;
            display: grid;
            height: 100vh;
        }

        .card-header {
            background-color: #013a51;
            color: #fff;
        }
    </style>
</head>

<body>

    <body>
        <div>
            <div class="card">
                <div class="card-header">
                    Payment completed. Thank You!
                </div>
                <div class="card-body">
                    <h5 class="card-title">Payment Details:</h5>
                    <p id="ref" class="card-text">Reference: <span></span></p>
                    <ul class="list-group list-group-flush">
                        <li id="" class="list-group-item"><b>Order Details</b></li>
                        <li id="amount" class="list-group-item">Amount: <span></span></li>
                        <li id="method" class="list-group-item">Payment Method: <span></span></li>
                        <li id="status" class="list-group-item">Status: <span></span></li>
                </div>
            </div>
        </div>

        <script>
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const txnID = urlParams.get('id');
            console.log(queryString);

            var myHeaders = new Headers();
            myHeaders.append("Authorization", "sk_test_520984d1-5a3f-45df-84b0-060f650a9a81");
            myHeaders.append("Content-Type", "application/json");

            var requestOptions = {
                method: 'GET',
                headers: myHeaders,
                redirect: 'follow'
            }

            fetch("https://api.sandbox.checkout.com/payments/" + txnID, requestOptions)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(response.status + ": " + response.statusText);
                    }
                    return response.text();
                })
                .then(result => {
                    console.log(result);
                    _result = JSON.parse(result);
                    console.log(_result.source.scheme);
                    document.querySelector("#ref > span").innerHTML = _result.source.description;
                    document.querySelector("#amount > span").innerHTML = _result.amount / 100 + " " + _result.currency;
                    document.querySelector("#method > span").innerHTML = _result.source.type;
                    document.querySelector("#status > span").innerHTML = _result.status;
                }).catch(error => {
                    console.log('error', error);
                    print(el, error);
                });
        </script>
    </body>

</html>